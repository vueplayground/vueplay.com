import{V as Ve,F as Ae}from"./Footer-56d73a09.js";import{M as Ie}from"./Meta-c22817e0.js";import{h as Se}from"./moment-fbc5633a.js";import{_ as Ce,r as A,o as i,c as r,a as I,b as s,h as S,g as d,t as u,n as z,w as _,k as V,d as p,l as ze,F as Me,j as Le,m as Be,v as De,p as He,f as Ye,q as je}from"./index-25143313.js";const Fe={components:{Meta:Ie},inject:["io","user","login","logout"],emit:["post"],props:{id:{type:String,default:"64bae1b0ca444b8b5e20cd5d"}},data:()=>({comment:"",edit:!1,post:null,moment:Se}),created(){this.refresh()},methods:{async postComment(){await this.login()?(await this.io.service("types/feedback-comments").create({feedback_id:this.post._id,comment:this.comment}),await this.refresh(),this.comment="",alert("Posted!")):alert("You need to be logged in to post a comment")},async saveComment(e){await this.io.service("types/feedback-comments").patch(e._id,{comment:e.comment}),e.edit=!1,alert("Saved")},async removeComment(e){confirm("Delete comment?")&&(await this.io.service("types/feedback-comments").remove(e._id),await this.refresh(),alert("Removed!"))},async savePost(){await this.io.service("types/feedback").patch(this.post._id,{title:this.post.title,description:this.post.description,screenshot:this.post.screenshot}),await this.refresh(),this.edit=!1,alert("Saved")},async remove(e){confirm("Delete post?")&&(await this.io.service("types/feedback").remove(e._id),alert("Removed!"),this.$router.push("/feedback"))},async refresh(){this.post=await this.io.service("types/feedback").get(this.id),this.$emit("post",this.post)},async myVote(e){var m;const o=await this.io.service("types/feedback-votes").find({query:{feedback_id:e._id,user_id:(m=this.user)==null?void 0:m._id}});return(o==null?void 0:o[0])||!1},async vote(e){if(await this.login()){const o=await this.myVote(e);o?await this.io.service("types/feedback-votes").remove(o._id):await this.io.service("types/feedback-votes").create({feedback_id:e._id}),await this.refreshVotes(e)}else alert("You have to be logged in to cast a vote")},async refreshVotes(e){e.votes=await this.io.service("types/feedback-votes").find({query:{feedback_id:e._id}})},async myLike(e){var m;const o=await this.io.service("types/feedback-likes").find({query:{comment_id:e._id,user_id:(m=this.user)==null?void 0:m._id}});return(o==null?void 0:o[0])||!1},async like(e){if(await this.login()){const o=await this.myLike(e);o?await this.io.service("types/feedback-likes").remove(o._id):await this.io.service("types/feedback-likes").create({comment_id:e._id}),await this.refreshLikes(e)}else alert("You have to be logged in to like")},async refreshLikes(e){e.likes=await this.io.service("types/feedback-likes").find({query:{comment_id:e._id}})},selectImage(){let e=document.createElement("input");e.type="file",e.multiple=!1,e.accept="image/*",e.onchange=async()=>{let m=Array.from(e.files)[0],f=new FileReader;f.readAsDataURL(m),f.onload=async w=>{this.post.screenshot=await this.resizeImage(w.target.result)},f.onerror=w=>{alert("Could not load file"),console.log(w)}},e.click()},resizeImage(e){return new Promise((o,m)=>{let f=1e3,w=1e3,l=document.createElement("canvas"),k=l.getContext("2d"),v=new Image;v.onload=()=>{let h=v.width,n=v.height;h>n?h>f&&(n*=f/h,h=f):n>w&&(h*=w/n,n=w),l.width=h,l.height=n,k.drawImage(v,0,0,h,n);let g=l.toDataURL("image/png",.7);o(g)},v.src=e})}}},Ne={class:"p-6 md:pt-6 pb-24"},Ue={class:"absolute left-0 right-0 top-0 h-16 p-2 bg-slate-50"},Pe={key:1,class:"float-right mt-3 mr-4"},Te={class:"mt-16"},qe={class:"max-w-2xl mx-auto mt-4 flex"},Re={class:"w-16 inline-flex"},Ee={class:"h-1/2 w-full"},Ge=s("polygon",{points:"10,0 20,10 0,10"},null,-1),Ke=[Ge],Xe={class:"text-center h-1/2 w-full -mt-1"},$e={class:"overflow-hidden text-ellipsis max-h-20 flex-col inline-flex grow"},We={key:0,class:"pt-2.5 text-xl font-semibold"},Je={class:"max-w-2xl mx-auto mt-4 flex"},Oe={class:"w-16 inline-flex"},Qe={class:"w-11"},Ze={class:"overflow-hidden text-ellipsis max-h-8 flex-col inline-flex grow"},es={class:"font-semibold mt-0.5"},ss={key:0,class:"max-w-2xl mx-auto mb-8 mt-2 flex"},ts=s("div",{class:"w-16 inline-flex"},[s("div",{class:"w-16"})],-1),os={class:"grow"},ls={key:0,class:"text-gray-700 mb-3"},is=["src"],rs={class:"mt-2 flex text-gray-500"},as={class:"text-xs"},ds=s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 cursor-pointer inline-flex -mt-1"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})],-1),ns={key:1,class:"text-xs ml-1"},cs=s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"},null,-1),us=[cs],hs={class:"mt-8"},ms={class:"mt-4"},ps={class:"relative"},vs=s("div",{class:"mt-10"},[s("p",{class:"text-gray-500"}," Activity Feed ")],-1),fs={class:"max-w-2xl mx-auto mt-4 flex"},ws={class:"w-16 inline-flex"},gs={class:"w-11"},_s={class:"overflow-hidden text-ellipsis max-h-8 flex-col inline-flex grow"},ks={class:"font-semibold mt-0.5"},bs={class:"max-w-2xl mx-auto mb-8 mt-2 flex"},ys=s("div",{class:"w-16 inline-flex"},[s("div",{class:"w-16"})],-1),xs={class:"grow"},Cs={key:0,class:"text-gray-700 mb-3"},Ms=["onUpdate:modelValue"],Ls=["onClick"],Vs={class:"flex text-gray-500"},As=["onClick"],Is=s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"},null,-1),Ss=[Is],zs={class:"text-xs"},Bs={key:0,class:"text-xs ml-1"},Ds=["onClick"],Hs=s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"},null,-1),Ys=[Hs],js=["onClick"],Fs=s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 cursor-pointer inline-flex -mt-0.5"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})],-1);function Ns(e,o,m,f,w,l){var v,h,n,g,c,b,y,x,C,B,D,H,Y,j,F,N,U,P,T,q,R,E,G,K,X,$,W,J,O,Q,Z,ee,se,te,oe,le,ie,re,ae,de,ne,ce;const k=A("Meta");return i(),r("section",Ne,[I(k,{title:(v=e.post)==null?void 0:v.title,description:(h=e.post)==null?void 0:h.description,author:(g=(n=e.post)==null?void 0:n.user)==null?void 0:g.name},null,8,["title","description","author"]),s("div",Ue,[(c=l.user)!=null&&c.email||(y=(b=l.user)==null?void 0:b.value)!=null&&y.email?(i(),r("div",{key:0,class:"h-12 w-12 bg-cover rounded-full bg-slate-500 mx-auto float-right",style:S("background-image: url("+(((x=l.user)==null?void 0:x.picture)||((B=(C=l.user)==null?void 0:C.value)==null?void 0:B.picture))+")")},null,4)):d("",!0),(D=l.user)!=null&&D.email||(Y=(H=l.user)==null?void 0:H.value)!=null&&Y.email?(i(),r("div",Pe,u(((j=l.user)==null?void 0:j.name)||((N=(F=l.user)==null?void 0:F.value)==null?void 0:N.name)),1)):d("",!0),(U=l.user)!=null&&U.email||(T=(P=l.user)==null?void 0:P.value)!=null&&T.email?(i(),r("div",{key:2,class:"float-left mt-3 ml-4 cursor-pointer text-slate-700 hover:text-slate-900 font-bold",onClick:o[0]||(o[0]=(...t)=>l.logout&&l.logout(...t))}," Logout ")):(i(),r("div",{key:3,class:"float-left mt-3 ml-4 cursor-pointer text-slate-700 hover:text-slate-900 font-bold",onClick:o[1]||(o[1]=(...t)=>l.login&&l.login(...t))}," Login "))]),s("article",Te,[s("div",qe,[s("div",Re,[s("div",{class:z(["border w-11 h-12 rounded-lg cursor-pointer",{"bg-emerald-50":(q=e.post)==null?void 0:q.votes.find(t=>{var a;return t.user_id===((a=l.user)==null?void 0:a._id)}),"border-emerald-400":(R=e.post)==null?void 0:R.votes.find(t=>{var a;return t.user_id===((a=l.user)==null?void 0:a._id)}),"hover:bg-emerald-100":(E=e.post)==null?void 0:E.votes.find(t=>{var a;return t.user_id===((a=l.user)==null?void 0:a._id)}),"hover:bg-slate-100":!((G=e.post)!=null&&G.votes.find(t=>{var a;return t.user_id===((a=l.user)==null?void 0:a._id)})),"border-emerald-400":(K=e.post)==null?void 0:K.votes.find(t=>{var a;return t.user_id===((a=l.user)==null?void 0:a._id)})}]),onClick:o[2]||(o[2]=t=>l.vote(e.post))},[s("div",Ee,[(i(),r("svg",{viewBox:"0 0 20 10",class:z(["pt-2 w-5 h-5 mx-auto",{"fill-emerald-400":(X=e.post)==null?void 0:X.votes.find(t=>{var a;return t.user_id===((a=l.user)==null?void 0:a._id)}),"fill-gray-400":!(($=e.post)!=null&&$.votes.find(t=>{var a;return t.user_id===((a=l.user)==null?void 0:a._id)}))}])},Ke,2))]),s("div",Xe,u((J=(W=e.post)==null?void 0:W.votes)==null?void 0:J.length),1)],2)]),s("div",$e,[e.edit?e.post?_((i(),r("input",{key:1,class:"pt-2.5 text-xl font-semibold","onUpdate:modelValue":o[3]||(o[3]=t=>e.post.title=t)},null,512)),[[V,e.post.title]]):d("",!0):(i(),r("h1",We,u((O=e.post)==null?void 0:O.title),1))])]),s("div",Je,[s("div",Oe,[s("div",Qe,[s("div",{class:"h-7 w-7 bg-cover rounded-full bg-slate-500 mx-auto",style:S("background-image: url("+((Z=(Q=e.post)==null?void 0:Q.user)==null?void 0:Z.picture)+")")},null,4)])]),s("div",Ze,[s("h1",es,u((se=(ee=e.post)==null?void 0:ee.user)==null?void 0:se.name),1)])]),e.post?(i(),r("div",ss,[ts,s("div",os,[e.edit?_((i(),r("textarea",{key:1,"onUpdate:modelValue":o[4]||(o[4]=t=>e.post.description=t),rows:"",cols:"",class:"rounded w-full h-32 mb-3 border"},`
`,512)),[[V,e.post.description]]):(i(),r("p",ls,u((te=e.post)==null?void 0:te.description),1)),(oe=e.post)!=null&&oe.screenshot?(i(),r("img",{key:2,class:"rounded w-full mb-4",src:e.post.screenshot},null,8,is)):d("",!0),p(),e.edit?(i(),r("button",{key:3,class:"mr-2 bg-slate-50 hover:bg-slate-100 shadow rounded px-2 mb-2 py-2",onClick:o[5]||(o[5]=(...t)=>l.selectImage&&l.selectImage(...t))}," Select screenshot ")):d("",!0),e.edit?(i(),r("button",{key:4,class:"mr-2 bg-slate-50 hover:bg-slate-100 shadow rounded px-2 mb-2 py-2",onClick:o[6]||(o[6]=t=>e.post.screenshot="")}," Remove screenshot ")):d("",!0),e.edit?(i(),r("button",{key:5,class:"bg-emerald-400 text-white hover:bg-emerald-500 shadow rounded px-2 mb-2 py-2",onClick:o[7]||(o[7]=t=>l.savePost())}," Save ")):d("",!0),s("div",rs,[s("span",as,u(e.moment(e.post.createdAt).format("MMMM DD, YYYY")),1),p(),((ie=(le=e.post)==null?void 0:le.user)==null?void 0:ie._id)===((re=l.user)==null?void 0:re._id)?(i(),r("span",{key:0,class:"text-xs ml-1",onClick:o[8]||(o[8]=t=>l.remove(e.post))},[p(" · "),ds])):d("",!0),p(),!e.edit&&((de=(ae=e.post)==null?void 0:ae.user)==null?void 0:de._id)===((ne=l.user)==null?void 0:ne._id)?(i(),r("span",ns,[p(" · "),(i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 cursor-pointer inline-flex -mt-0.5",onClick:o[9]||(o[9]=t=>e.edit=!0)},us))])):d("",!0)]),s("div",hs,[s("form",ms,[s("div",ps,[_(s("input",{type:"search",id:"default-search",class:"w-full h-10 block max-w-full pl-4 pr-2 text-sm text-gray-900 placeholder:text-slate-500 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Leave a comment",required:"","onUpdate:modelValue":o[10]||(o[10]=t=>e.comment=t),onKeypress:o[11]||(o[11]=ze(Be(t=>l.postComment(),["prevent"]),["enter"]))},null,544),[[V,e.comment]])])])]),vs])])):d("",!0)]),(i(!0),r(Me,null,Le((ce=e.post)==null?void 0:ce.comments,t=>{var a,ue,he,me,pe,ve,fe,we,ge,_e,ke,be,ye,xe;return i(),r("article",null,[s("div",fs,[s("div",ws,[s("div",gs,[s("div",{class:"h-7 w-7 bg-cover rounded-full bg-slate-500 mx-auto",style:S("background-image: url("+((ue=(a=t==null?void 0:t.user)==null?void 0:a[0])==null?void 0:ue.picture)+")")},null,4)])]),s("div",_s,[s("h1",ks,u((me=(he=t.user)==null?void 0:he[0])==null?void 0:me.name),1)])]),s("div",bs,[ys,s("div",xs,[t.edit?_((i(),r("textarea",{key:1,"onUpdate:modelValue":M=>t.comment=M,rows:"",cols:"",class:"w-full h-16 mb-3 border"},`
`,8,Ms)),[[V,t.comment]]):(i(),r("p",Cs,u(t.comment),1)),t.edit?(i(),r("button",{key:2,class:"bg-emerald-400 text-white hover:bg-emerald-500 shadow rounded px-2 mb-2 py-2",onClick:M=>l.saveComment(t)}," Save ",8,Ls)):d("",!0),s("div",Vs,[(i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:z(["w-4 h-4 mr-1 cursor-pointer",{"fill-red-400":t.likes.length}]),onClick:M=>l.like(t)},Ss,10,As)),p(),s("span",zs,u(((pe=t.likes)==null?void 0:pe.length)>1?((ve=t.likes)==null?void 0:ve.length)+" likes":"")+" "+u(((fe=t.likes)==null?void 0:fe.length)===1?((we=t.likes)==null?void 0:we.length)+" like":"")+" · "+u(e.moment(t.createdAt).format("MMMM DD, YYYY")),1),p(),((_e=(ge=t==null?void 0:t.user)==null?void 0:ge[0])==null?void 0:_e._id)===((ke=l.user)==null?void 0:ke._id)?(i(),r("span",Bs,[p(" · "),(i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 cursor-pointer inline-flex -mt-1",onClick:M=>l.removeComment(t)},Ys,8,Ds))])):d("",!0),p(),((ye=(be=t==null?void 0:t.user)==null?void 0:be[0])==null?void 0:ye._id)===((xe=l.user)==null?void 0:xe._id)&&!t.edit?(i(),r("span",{key:1,class:"text-xs ml-1",onClick:M=>t.edit=!0},[p(" · "),Fs],8,js)):d("",!0)])])])])}),256))])}const Us=Ce(Fe,[["render",Ns]]);const Ps={props:["id"],components:{VueNavigator:Ve,Footer:Ae,Topic:Us},data:()=>({menu:!1,post:null}),computed:{votes(){var e;return(e=this.post)==null?void 0:e.votes}}},L=e=>(He("data-v-0b430c33"),e=e(),Ye(),e),Ts={class:"bg-white flex flex-col h-screen"},qs={style:{width:"100%","min-height":"calc(100vh - 50px)"},class:"flex-1 relative overflow-auto"},Rs={class:"relative h-full w-full flex"},Es=L(()=>s("label",{class:"bg-white fixed z-40 md:hidden cursor-pointer inline-flex items-center p-2 mt-16 lg:mt-4 ml-3 text-sm text-slate-900 rounded-lg",for:"toggle"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})])],-1)),Gs={class:"bottom-0 bg-white pt-10 md:w-96 md:p-7 md:shadow-md shadow-lg border-r border-slate-200 peer-checked:px-7 peer-checked:pt-16 peer-checked:md:pt-10 peer-checked:pb-7 duration-200 transition-all ease-in-out w-0 max-w-full z-30 peer-checked:w-80 absolute md:relative top-0 overflow-auto"},Ks=L(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-5 h-5 -mt-1 mr-1 inline"},[s("path",{"fill-rule":"evenodd",d:"M11.03 3.97a.75.75 0 010 1.06l-6.22 6.22H21a.75.75 0 010 1.5H4.81l6.22 6.22a.75.75 0 11-1.06 1.06l-7.5-7.5a.75.75 0 010-1.06l7.5-7.5a.75.75 0 011.06 0z","clip-rule":"evenodd"})],-1)),Xs=L(()=>s("h3",{class:"text-slate-500 font-medium mb-1 whitespace-nowrap"}," Category ",-1)),$s=L(()=>s("h3",{class:"text-slate-500 mt-4 font-medium mb-2 whitespace-nowrap"}," Voters ",-1)),Ws={class:"flex mb-1.5"},Js={class:"text-sm pl-2 pt-1 text-ellipsis overflow-hidden whitespace-nowrap grow"},Os={class:"flex mb-1.5"},Qs=L(()=>s("div",{class:"h-7 w-7"},null,-1)),Zs={class:"text-sm pl-2 pt-1 text-ellipsis overflow-hidden whitespace-nowrap grow"};function et(e,o,m,f,w,l){var n,g;const k=A("VueNavigator"),v=A("Topic"),h=A("Footer");return i(),r("div",Ts,[I(k,{class:"absolute z-50"}),s("main",qs,[s("div",Rs,[Es,_(s("input",{class:"peer hidden",type:"checkbox",id:"toggle","onUpdate:modelValue":o[0]||(o[0]=c=>e.menu=c)},null,512),[[De,e.menu]]),s("div",Gs,[s("button",{class:"border mr-2 bg-slate-50 hover:bg-slate-100 rounded-2xl px-2 mb-4 py-2",onClick:o[1]||(o[1]=c=>e.$router.push("/feedback"))},[Ks,p(" Go back ")]),Xs,s("span",null,u(((g=(n=e.post)==null?void 0:n.category)==null?void 0:g.title)||"Not set"),1),$s,(i(!0),r(Me,null,Le(l.votes,c=>{var b,y,x,C;return i(),r("div",Ws,[s("div",{class:"h-7 w-7 bg-cover rounded-full bg-slate-500",style:S("background-image: url("+((y=(b=c==null?void 0:c.user)==null?void 0:b[0])==null?void 0:y.picture)+")")},null,4),s("span",Js,u((C=(x=c.user)==null?void 0:x[0])==null?void 0:C.name),1)])}),256)),s("div",Os,[Qs,_(s("span",Zs," and 35 more... ",512),[[je,!1]])])]),I(v,{class:"m-auto grow h-full overflow-auto pt-16 lg:pt-7 relative",onPost:o[2]||(o[2]=c=>e.post=c),id:m.id},null,8,["id"]),e.menu?(i(),r("div",{key:0,class:"absolute h-full w-full",onClick:o[3]||(o[3]=c=>e.menu=!1)})):d("",!0)])]),I(h)])}const it=Ce(Ps,[["render",et],["__scopeId","data-v-0b430c33"]]);export{it as default};
